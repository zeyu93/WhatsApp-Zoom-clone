{"version":3,"sources":["components/Login.js","hooks/useLocalStorage.js","contexts/ContactsProvider.js","contexts/SocketProvider.js","contexts/ConversationsProvider.js","components/Message.js","components/MessageList.js","components/Chat.js","components/Conversations.js","components/ConversationsModal.js","components/ContactsModal.js","components/Contacts.js","components/Sidebar.js","components/Dashboard.js","components/App.js","index.js"],"names":["Login","setId","setName","nameRef","useRef","generateNewID","newID","uuidv4","Container","className","style","height","Accordion","Card","Header","Toggle","as","Button","variant","eventKey","Collapse","Body","Form","onSubmit","e","preventDefault","current","value","Group","Label","Control","type","ref","required","onClick","useLocalStorage","key","initialValue","prefixedKey","useState","jsonValue","localStorage","getItem","JSON","parse","setValue","useEffect","setItem","stringify","ContactsContext","React","createContext","useContacts","useContext","ContactsProvider","children","contacts","setContacts","Provider","createContact","id","name","prevContacts","SocketContext","SocketProvider","socket","setSocket","console","log","process","REACT_APP_DEV_URL","newSocket","io","query","close","ConversationContext","useConversation","ConversationsProvider","conversations","setConversations","selectedConvoIndex","setSelectedConvoIndex","formattedConversations","map","convo","index","chatMembers","ids","person","find","contact","messages","message","sender","fromMe","senderName","selected","addMessageToConversation","useCallback","text","newMessage","prevConvos","madeChange","newConversations","isArrayEqual","on","off","createConversation","prevConversations","existingConvoIndex","some","selectConversationIndex","selectedConversation","sendMessage","member","emit","array1","array2","length","sort","every","element","Message","isLastMessage","setRef","node","scrollIntoView","smooth","MessageList","Chat","setText","InputGroup","onChange","target","resize","Append","Conversations","ListGroup","varaiant","Item","action","active","array","join","ConversationsModal","closeModal","selectedContactIds","setSelectedContactIds","Modal","closeButton","controlId","Check","includes","label","filter","prevId","ContactsModal","idRef","Contacts","CONTACTS_KEY","CONVERSATIONS_KEY","Sidebar","activeKey","setActiveKey","showModal","setShowModal","conversationOpen","width","Tab","onSelect","Nav","Link","Content","Pane","show","onHide","Dashboard","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.41c28ed8.chunk.js","sourcesContent":["import React, { useRef } from \"react\";\nimport { Button, Container, Form, Accordion, Card } from \"react-bootstrap\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport default function Login({ setId, setName }) {\n  const nameRef = useRef();\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setName(nameRef.current.value);\n    generateNewID();\n  };\n\n  const generateNewID = () => {\n    const newID = uuidv4();\n    setId(newID);\n  };\n  return (\n    <Container\n      className='d-flex flex-column justify-content-center'\n      style={{ height: \"100vh\" }}\n    >\n      <Accordion>\n        <Card>\n          <Card.Header className=\"text-center\"> \n            <Accordion.Toggle as={Button} variant='link' eventKey='0'>\n              READ ME!\n            </Accordion.Toggle>\n          </Card.Header>\n          <Accordion.Collapse eventKey='0'>\n            <Card.Body>\n              Hello! This is a WhatsApp clone built by Zeyu Liu using SocketIO\n              and React Hooks. Enter your name and press start or create a random ID.\n              Add a contact by their ID and can start a conversation with one or multiple contacts.\n            </Card.Body>\n          </Accordion.Collapse>\n        </Card>\n      </Accordion>\n      <Form onSubmit={handleSubmit} className='w-100'>\n        <Form.Group>\n          <Form.Label>Enter Your Name</Form.Label>\n          <Form.Control type='text' ref={nameRef} required />\n        </Form.Group>\n        <Button type='submit' className='mr-2'>\n          Start\n        </Button>\n        <Button variant='secondary' onClick={generateNewID}>\n          Create Random ID\n        </Button>\n      </Form>\n    </Container>\n  );\n}\n","import { useState, useEffect } from \"react\";\nconst PREFIX = \"whatsapp-clone-\";\nexport default function useLocalStorage(key, initialValue) {\n  const prefixedKey = PREFIX + key;\n  const [value, setValue] = useState(() => {\n    const jsonValue = localStorage.getItem(prefixedKey);\n    if (jsonValue != null) return JSON.parse(jsonValue);\n    if (typeof initialValue === \"function\") {\n      return initialValue();\n    } else {\n      return initialValue;\n    }\n  });\n\n  useEffect(() => {\n    localStorage.setItem(prefixedKey, JSON.stringify(value));\n  }, [prefixedKey, value]);\n\n  return [value, setValue];\n}\n","import React, { useContext } from \"react\";\nimport useLocalStorage from \"../hooks/useLocalStorage\";\nconst ContactsContext = React.createContext();\n\nexport const useContacts = () => {\n  return useContext(ContactsContext);\n};\n\nexport const ContactsProvider = ({ children }) => {\n  const [contacts, setContacts] = useLocalStorage(\"contacts\", []);\n  const createContact = (id, name) => {\n    setContacts(prevContacts => {\n      return [...prevContacts, { id, name }];\n    });\n  };\n  return (\n    <ContactsContext.Provider value={{ contacts, createContact }}>\n      {children}\n    </ContactsContext.Provider>\n  );\n};\n","import React, { useContext, useState, useEffect } from \"react\";\nimport io from \"socket.io-client\";\n\nconst SocketContext = React.createContext();\n\nexport const useSocket = () => {\n  return useContext(SocketContext);\n};\n\nexport const SocketProvider = ({ id, children }) => {\n  const [socket, setSocket] = useState();\n  console.log(process.env.REACT_APP_DEV_URL)\n  useEffect(() => {\n    const newSocket = io(\n      process.env.REACT_APP_DEV_URL,\n      {\n        query: { id },\n      },\n      [id]\n    );\n    setSocket(newSocket);\n\n    return () => newSocket.close();\n  }, [id]);\n\n  return (\n    <SocketContext.Provider value={socket}>{children}</SocketContext.Provider>\n  );\n};\n","import React, { useContext, useState, useEffect, useCallback } from \"react\";\nimport useLocalStorage from \"../hooks/useLocalStorage\";\nimport { useContacts } from \"./ContactsProvider\";\nimport { useSocket } from \"./SocketProvider\";\nconst ConversationContext = React.createContext();\n\nexport const useConversation = () => {\n  return useContext(ConversationContext);\n};\n\nexport const ConversationsProvider = ({ children, id }) => {\n  const { contacts } = useContacts();\n  const [conversations, setConversations] = useLocalStorage(\"coversations\", []);\n  const [selectedConvoIndex, setSelectedConvoIndex] = useState(0);\n  const socket = useSocket();\n\n  const createConversation = (ids) => {\n    setConversations((prevConversations) => {\n      let existingConvoIndex = null;\n      const existingConvo = prevConversations.some((convo, index) => {\n        if (isArrayEqual(convo.ids, ids)) {\n          existingConvoIndex = index;\n          return true;\n        } else {\n          return false;\n        }\n      });\n      if (existingConvo) {\n        setSelectedConvoIndex(existingConvoIndex);\n        return [...prevConversations];\n      }\n      return [...prevConversations, { ids, messages: [] }];\n    });\n  };\n\n  const formattedConversations = conversations.map((convo, index) => {\n    console.log('test',convo);\n    const chatMembers = convo.ids.map((id) => {\n      const person = contacts.find((contact) => {\n        return contact.id === id;\n      });\n      const name = (person && person.name) || id;\n      return { id, name };\n    });\n    const messages = convo.messages.map((message) => {\n      const person = contacts.find((contact) => {\n        return contact.id === message.sender;\n      });\n      const name = (person && person.name) || message.sender;\n      const fromMe = message.sender === id;\n      return { ...message, senderName: name, fromMe };\n    });\n    const selected = index === selectedConvoIndex;\n    return { ...convo, messages, chatMembers, selected };\n  });\n\n  const addMessageToConversation = useCallback(\n    ({ ids, text, sender }) => {\n      let newMessage = {\n        sender,\n        text,\n      };\n      setConversations((prevConvos) => {\n        let madeChange = false;\n        const newConversations = prevConvos.map((convo) => {\n          if (isArrayEqual(convo.ids, ids)) {\n            madeChange = true;\n            return { ...convo, messages: [...convo.messages, newMessage] };\n          }\n          return convo;\n        });\n        if (madeChange) {\n          return newConversations;\n        } else {\n          return [...prevConvos, { ids, messages: [newMessage] }];\n        }\n      });\n    },\n    [setConversations]\n  );\n\n  useEffect(() => {\n    if (!socket) return;\n    socket.on(\"receive-message\", addMessageToConversation);\n    return () => socket.off(\"receive-message\");\n  }, [socket, addMessageToConversation]);\n\n  const sendMessage = (text) => {\n    const currentConversation = formattedConversations[selectedConvoIndex];\n    const ids = currentConversation.chatMembers.map(\n      (member) => member.id\n    );\n    socket.emit(\"send-message\", { ids, text, sender: id });\n    addMessageToConversation({\n      ids,\n      text,\n      sender: id,\n    });\n  };\n  return (\n    <ConversationContext.Provider\n      value={{\n        conversations: formattedConversations,\n        createConversation,\n        selectConversationIndex: setSelectedConvoIndex,\n        selectedConversation: formattedConversations[selectedConvoIndex],\n        sendMessage,\n      }}\n    >\n      {children}\n    </ConversationContext.Provider>\n  );\n};\n\nconst isArrayEqual = (array1, array2) => {\n  if (array1.length !== array2.length) return false;\n  array2.sort();\n  array1.sort();\n  return array1.every((element, index) => element === array2[index]);\n};\n","import React, { useCallback } from \"react\";\n\nfunction Message({ message, isLastMessage }) {\n  const setRef = useCallback((node) => {\n    if (node) {\n      node.scrollIntoView({ smooth: true });\n    }\n  }, []);\n  return (\n    <div\n      className={`my-1 d-flex flex-column ${\n        message.fromMe ? \"align-self-end\" : \"\"\n      }`}\n      ref={isLastMessage ? setRef : null}\n    >\n      <div\n        className={`rounded px-2 py-1 ${\n          message.fromMe ? \"bg-primary text-white\" : \"border\"\n        }`}\n      >\n        {message.text}\n      </div>\n      <div className={`text-muted small ${message.fromMe ? \"text-right\" : \"\"}`}>\n        {message.fromMe ? \"You\" : message.sender}\n      </div>\n    </div>\n  );\n}\n\nexport default Message;\n","import React from \"react\";\nimport Message from \"./Message\";\n\nfunction MessageList({ selectedConversation }) {\n  return (\n    <div className='d-flex flex-column align-items-start justify-content-end px-3'>\n      {selectedConversation.messages.map((message, index) => {\n        const isLastMessage =\n          selectedConversation.messages.length - 1 === index;\n        return (\n          <Message\n            isLastMessage={isLastMessage}\n            key={index}\n            message={message}\n          />\n        );\n      })}\n    </div>\n  );\n}\n\nexport default MessageList;\n","import React, { useState } from \"react\";\nimport { Form, InputGroup, Button } from \"react-bootstrap\";\nimport { useConversation } from \"../contexts/ConversationsProvider\";\nimport MessageList from \"./MessageList\";\n\nfunction Chat() {\n  const [text, setText] = useState(\"\");\n  const { sendMessage, selectedConversation } = useConversation();\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    sendMessage(text);\n    setText(\"\");\n  };\n\n  return (\n    <div className='d-flex flex-column flex-grow-1'>\n      <div className='flex-grow-1 overflow-auto'>\n        <MessageList selectedConversation={selectedConversation} />\n      </div>\n      <Form>\n        <Form.Group className='m-2'>\n          <InputGroup>\n            <Form.Control\n              as='textarea'\n              required\n              value={text}\n              onChange={(e) => setText(e.target.value)}\n              style={{ height: \"100px\", resize: \"none\" }}\n            />\n            <InputGroup.Append>\n              <Button onClick={handleSubmit} type='submit'>\n                Send\n              </Button>\n            </InputGroup.Append>\n          </InputGroup>\n        </Form.Group>\n      </Form>\n    </div>\n  );\n}\n\nexport default Chat;\n","import React from \"react\";\nimport { ListGroup } from \"react-bootstrap\";\nimport { useConversation } from \"../contexts/ConversationsProvider\";\n\nfunction Conversations() {\n  const { conversations, selectConversationIndex } = useConversation();\n  const displayNames = (array) => {\n    const names = array.map((member) => member.name);\n    return names.join(\", \");\n  };\n\n \n  return (\n    <ListGroup varaiant='flush'>\n      {conversations.map((convo, index) => {\n        return (\n          <ListGroup.Item\n            key={index}\n            action\n            active={convo.selected}\n            onClick={() => selectConversationIndex(index)}\n          >\n            {displayNames(convo.chatMembers)}\n          </ListGroup.Item>\n        );\n      })}\n    </ListGroup>\n  );\n}\n\nexport default Conversations;\n","import React, { useState } from \"react\";\nimport { Modal, Form, Button } from \"react-bootstrap\";\nimport { useContacts } from \"../contexts/ContactsProvider\";\nimport { useConversation } from \"../contexts/ConversationsProvider\";\n\nfunction ConversationsModal({ closeModal }) {\n  const { contacts } = useContacts();\n  const { createConversation } = useConversation();\n  const [selectedContactIds, setSelectedContactIds] = useState([]);\n\n  const handleCheckBox = id => {\n    setSelectedContactIds(prevContacts => {\n      if (prevContacts.includes(id)) {\n        return prevContacts.filter(prevId => prevId.id !== id);\n      } else {\n        return [...prevContacts, id];\n      }\n    });\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    createConversation(selectedContactIds);\n    closeModal();\n  };\n\n  return (\n    <>\n      <Modal.Header closeButton>Create Conversation</Modal.Header>\n      <Modal.Body>\n        <Form onSubmit={handleSubmit}>\n          {contacts.map(contact => {\n            return (\n              <Form.Group controlId={contact.id} key={contact.id}>\n                <Form.Check\n                  type='checkbox'\n                  value={selectedContactIds.includes(contact.id)}\n                  label={contact.name}\n                  onChange={() => {\n                    handleCheckBox(contact.id);\n                  }}\n                />\n              </Form.Group>\n            );\n          })}\n          <Button type='submit'>Create Conversation</Button>\n        </Form>\n      </Modal.Body>\n    </>\n  );\n}\n\nexport default ConversationsModal;\n","import React, { useRef } from \"react\";\nimport { Modal, Form, Button } from \"react-bootstrap\";\nimport { useContacts } from \"../contexts/ContactsProvider\";\n\nfunction ContactsModal({ closeModal }) {\n  const idRef = useRef();\n  const nameRef = useRef();\n  const { createContact } = useContacts()\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    createContact(idRef.current.value, nameRef.current.value);\n    closeModal();\n  };\n  return (\n    <>\n      <Modal.Header closeButton>Create Contact</Modal.Header>\n      <Modal.Body>\n        <Form onSubmit={handleSubmit}>\n          <Form.Group>\n            <Form.Label>ID</Form.Label>\n            <Form.Control type='text' ref={idRef} required />\n          </Form.Group>\n\n          <Form.Group>\n            <Form.Label>Name</Form.Label>\n            <Form.Control type='text' ref={nameRef} required />\n          </Form.Group>\n          <Button type='submit'>Create Contact</Button>\n        </Form>\n      </Modal.Body>\n    </>\n  );\n}\n\nexport default ContactsModal;\n","import React from \"react\";\nimport { ListGroup } from \"react-bootstrap\";\nimport { useContacts } from \"../contexts/ContactsProvider\";\n\nconst Contacts = () => {\n  const { contacts } = useContacts();\n  return (\n    <ListGroup varaiant='flush'>\n      {contacts.map(contact => {\n        return <ListGroup.Item key={contact.id}>{contact.name}</ListGroup.Item>;\n      })}\n    </ListGroup>\n  );\n};\n\nexport default Contacts;\n","import React, { useState } from \"react\";\nimport { Tab, Nav, Button, Modal } from \"react-bootstrap\";\nimport Conversations from \"./Conversations\";\nimport ConversationsModal from \"./ConversationsModal.js\";\nimport ContactsModal from \"./ContactsModal\";\nimport Contacts from \"./Contacts\";\nconst CONTACTS_KEY = \"contacts\";\nconst CONVERSATIONS_KEY = \"conversations\";\n\nfunction Sidebar({ id }) {\n  const [activeKey, setActiveKey] = useState(CONVERSATIONS_KEY);\n  const [showModal, setShowModal] = useState(false);\n\n  const conversationOpen = activeKey === CONVERSATIONS_KEY;\n  const closeModal = () => {\n    setShowModal(false);\n  };\n  return (\n    <div style={{ width: \"250px\" }} className='d-flex flex-column'>\n      <Tab.Container activeKey={activeKey} onSelect={setActiveKey}>\n        <Nav variant='tabs' className='justify-content-center'>\n          <Nav.Item>\n            <Nav.Link eventKey={CONVERSATIONS_KEY}> Conversations</Nav.Link>\n          </Nav.Item>\n          <Nav.Item>\n            <Nav.Link eventKey={CONTACTS_KEY}>Contacts</Nav.Link>\n          </Nav.Item>\n        </Nav>\n        <Tab.Content className='border-right overflow-auto flex-grow-1'>\n          <Tab.Pane eventKey={CONVERSATIONS_KEY}>\n            <Conversations />\n          </Tab.Pane>\n          <Tab.Pane eventKey={CONTACTS_KEY}>\n            <Contacts />\n          </Tab.Pane>\n        </Tab.Content>\n        <div className='p-2 border-top border-right small'>\n          Your ID <span className='text-muted'> {id}</span>\n        </div>\n        <Button className='rounded-0' onClick={() => setShowModal(true)}>\n          NEW {conversationOpen ? \"CONVERSATION\" : \"CONTACTS\"}\n        </Button>\n      </Tab.Container>\n\n      <Modal show={showModal} onHide={closeModal}>\n        {conversationOpen ? (\n          <ConversationsModal closeModal={closeModal} />\n        ) : (\n          <ContactsModal closeModal={closeModal} />\n        )}\n      </Modal>\n    </div>\n  );\n}\n\nexport default Sidebar;\n","import React from \"react\";\nimport { useConversation } from \"../contexts/ConversationsProvider\";\nimport Chat from \"./Chat\";\nimport Sidebar from \"./Sidebar\";\n\nfunction Dashboard({ id }) {\n  const { selectedConversation } = useConversation();\n  return (\n    <div className='d-flex' style={{ height: \"100vh\" }}>\n      <Sidebar id={id} />\n      {selectedConversation && <Chat />}\n    </div>\n  );\n}\n\nexport default Dashboard;\n","import React from \"react\";\nimport Login from \"./Login\";\nimport useLocalStorage from \"../hooks/useLocalStorage\";\nimport Dashboard from \"./Dashboard\";\nimport { ContactsProvider } from \"../contexts/ContactsProvider\";\nimport { ConversationsProvider } from \"../contexts/ConversationsProvider\";\nimport { SocketProvider } from \"../contexts/SocketProvider\";\n\nfunction App() {\n  const [id, setId] = useLocalStorage(\"id\", null);\n  const [name, setName] = useLocalStorage(\"name\", null);\n  const dashBoard = (\n    <SocketProvider id={id}>\n      <ContactsProvider>\n        <ConversationsProvider id={id}>\n          <Dashboard id={id} />\n        </ConversationsProvider>\n      </ContactsProvider>\n    </SocketProvider>\n  );\n  return id ? dashBoard : <Login setId={setId} setName={setName} />;\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./components/App\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n"],"sourceRoot":""}