{"version":3,"sources":["components/Login.js","hooks/useLocalStorage.js","contexts/ContactsProvider.js","contexts/SocketProvider.js","contexts/ConversationsProvider.js","components/Message.js","components/MessageList.js","components/Chat.js","components/Conversations.js","components/ConversationsModal.js","components/ContactsModal.js","components/Contacts.js","components/Sidebar.js","components/Dashboard.js","components/App.js","index.js"],"names":["Login","setId","setName","nameRef","useRef","generateNewID","newID","uuidv4","Container","className","style","height","Accordion","Card","Header","Toggle","as","Button","variant","eventKey","Collapse","Body","Form","onSubmit","e","preventDefault","current","value","Group","Label","Control","type","ref","required","onClick","useLocalStorage","key","initialValue","prefixedKey","useState","jsonValue","localStorage","getItem","JSON","parse","setValue","useEffect","setItem","stringify","ContactsContext","React","createContext","useContacts","useContext","ContactsProvider","children","contacts","setContacts","Provider","createContact","id","name","prevContacts","SocketContext","SocketProvider","socket","setSocket","newSocket","io","query","close","ConversationContext","useConversation","ConversationsProvider","conversations","setConversations","selectedConvoIndex","setSelectedConvoIndex","formattedConversations","map","convo","index","console","log","chatMembers","ids","person","find","contact","messages","message","sender","fromMe","senderName","selected","addMessageToConversation","useCallback","text","newMessage","prevConvos","madeChange","newConversations","isArrayEqual","on","off","createConversation","prevConversations","existingConvoIndex","some","selectConversationIndex","selectedConversation","sendMessage","member","emit","array1","array2","length","sort","every","element","Message","isLastMessage","setRef","node","scrollIntoView","smooth","MessageList","Chat","setText","InputGroup","onChange","target","resize","Append","Conversations","ListGroup","varaiant","Item","action","active","array","join","ConversationsModal","closeModal","selectedContactIds","setSelectedContactIds","Modal","closeButton","controlId","Check","includes","label","filter","prevId","ContactsModal","idRef","Contacts","CONTACTS_KEY","CONVERSATIONS_KEY","Sidebar","activeKey","setActiveKey","showModal","setShowModal","conversationOpen","width","Tab","onSelect","Nav","Link","Content","Pane","show","onHide","Dashboard","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.59d2985f.chunk.js","sourcesContent":["import React, { useRef } from \"react\";\nimport { Button, Container, Form, Accordion, Card } from \"react-bootstrap\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport default function Login({ setId, setName }) {\n  const nameRef = useRef();\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setName(nameRef.current.value);\n    generateNewID();\n  };\n\n  const generateNewID = () => {\n    const newID = uuidv4();\n    setId(newID);\n  };\n  return (\n    <Container\n      className='d-flex flex-column justify-content-center'\n      style={{ height: \"100vh\" }}\n    >\n      <Accordion>\n        <Card>\n          <Card.Header className=\"text-center\"> \n            <Accordion.Toggle as={Button} variant='link' eventKey='0'>\n              READ ME!\n            </Accordion.Toggle>\n          </Card.Header>\n          <Accordion.Collapse eventKey='0'>\n            <Card.Body>\n              Hello! This is a WhatsApp clone built by Zeyu Liu using SocketIO\n              and React Hooks. Enter your name and press start or create a random ID.\n              Add a contact by their ID and can start a conversation with one or multiple contacts.\n            </Card.Body>\n          </Accordion.Collapse>\n        </Card>\n      </Accordion>\n      <Form onSubmit={handleSubmit} className='w-100'>\n        <Form.Group>\n          <Form.Label>Enter Your Name</Form.Label>\n          <Form.Control type='text' ref={nameRef} required />\n        </Form.Group>\n        <Button type='submit' className='mr-2'>\n          Start\n        </Button>\n        <Button variant='secondary' onClick={generateNewID}>\n          Create Random ID\n        </Button>\n      </Form>\n    </Container>\n  );\n}\n","import { useState, useEffect } from \"react\";\nconst PREFIX = \"whatsapp-clone-\";\nexport default function useLocalStorage(key, initialValue) {\n  const prefixedKey = PREFIX + key;\n  const [value, setValue] = useState(() => {\n    const jsonValue = localStorage.getItem(prefixedKey);\n    if (jsonValue != null) return JSON.parse(jsonValue);\n    if (typeof initialValue === \"function\") {\n      return initialValue();\n    } else {\n      return initialValue;\n    }\n  });\n\n  useEffect(() => {\n    localStorage.setItem(prefixedKey, JSON.stringify(value));\n  }, [prefixedKey, value]);\n\n  return [value, setValue];\n}\n","import React, { useContext } from \"react\";\nimport useLocalStorage from \"../hooks/useLocalStorage\";\nconst ContactsContext = React.createContext();\n\nexport const useContacts = () => {\n  return useContext(ContactsContext);\n};\n\nexport const ContactsProvider = ({ children }) => {\n  const [contacts, setContacts] = useLocalStorage(\"contacts\", []);\n  const createContact = (id, name) => {\n    setContacts(prevContacts => {\n      return [...prevContacts, { id, name }];\n    });\n  };\n  return (\n    <ContactsContext.Provider value={{ contacts, createContact }}>\n      {children}\n    </ContactsContext.Provider>\n  );\n};\n","import React, { useContext, useState, useEffect } from \"react\";\nimport io from \"socket.io-client\";\n\nconst SocketContext = React.createContext();\n\nexport const useSocket = () => {\n  return useContext(SocketContext);\n};\n\nexport const SocketProvider = ({ id, children }) => {\n  const [socket, setSocket] = useState();\n\n  useEffect(() => {\n    const newSocket = io(\n      \"http://localhost:5000\",\n      {\n        query: { id },\n      },\n      [id]\n    );\n    setSocket(newSocket);\n\n    return () => newSocket.close();\n  }, [id]);\n\n  return (\n    <SocketContext.Provider value={socket}>{children}</SocketContext.Provider>\n  );\n};\n","import React, { useContext, useState, useEffect, useCallback } from \"react\";\nimport useLocalStorage from \"../hooks/useLocalStorage\";\nimport { useContacts } from \"./ContactsProvider\";\nimport { useSocket } from \"./SocketProvider\";\nconst ConversationContext = React.createContext();\n\nexport const useConversation = () => {\n  return useContext(ConversationContext);\n};\n\nexport const ConversationsProvider = ({ children, id }) => {\n  const { contacts } = useContacts();\n  const [conversations, setConversations] = useLocalStorage(\"coversations\", []);\n  const [selectedConvoIndex, setSelectedConvoIndex] = useState(0);\n  const socket = useSocket();\n\n  const createConversation = (ids) => {\n    setConversations((prevConversations) => {\n      let existingConvoIndex = null;\n      const existingConvo = prevConversations.some((convo, index) => {\n        if (isArrayEqual(convo.ids, ids)) {\n          existingConvoIndex = index;\n          return true;\n        } else {\n          return false;\n        }\n      });\n      if (existingConvo) {\n        setSelectedConvoIndex(existingConvoIndex);\n        return [...prevConversations];\n      }\n      return [...prevConversations, { ids, messages: [] }];\n    });\n  };\n\n  const formattedConversations = conversations.map((convo, index) => {\n    console.log('test',convo);\n    const chatMembers = convo.ids.map((id) => {\n      const person = contacts.find((contact) => {\n        return contact.id === id;\n      });\n      const name = (person && person.name) || id;\n      return { id, name };\n    });\n    const messages = convo.messages.map((message) => {\n      const person = contacts.find((contact) => {\n        return contact.id === message.sender;\n      });\n      const name = (person && person.name) || message.sender;\n      const fromMe = message.sender === id;\n      return { ...message, senderName: name, fromMe };\n    });\n    const selected = index === selectedConvoIndex;\n    return { ...convo, messages, chatMembers, selected };\n  });\n\n  const addMessageToConversation = useCallback(\n    ({ ids, text, sender }) => {\n      let newMessage = {\n        sender,\n        text,\n      };\n      setConversations((prevConvos) => {\n        let madeChange = false;\n        const newConversations = prevConvos.map((convo) => {\n          if (isArrayEqual(convo.ids, ids)) {\n            madeChange = true;\n            return { ...convo, messages: [...convo.messages, newMessage] };\n          }\n          return convo;\n        });\n        if (madeChange) {\n          return newConversations;\n        } else {\n          return [...prevConvos, { ids, messages: [newMessage] }];\n        }\n      });\n    },\n    [setConversations]\n  );\n\n  useEffect(() => {\n    if (!socket) return;\n    socket.on(\"receive-message\", addMessageToConversation);\n    return () => socket.off(\"receive-message\");\n  }, [socket, addMessageToConversation]);\n\n  const sendMessage = (text) => {\n    const currentConversation = formattedConversations[selectedConvoIndex];\n    const ids = currentConversation.chatMembers.map(\n      (member) => member.id\n    );\n    socket.emit(\"send-message\", { ids, text, sender: id });\n    addMessageToConversation({\n      ids,\n      text,\n      sender: id,\n    });\n  };\n  return (\n    <ConversationContext.Provider\n      value={{\n        conversations: formattedConversations,\n        createConversation,\n        selectConversationIndex: setSelectedConvoIndex,\n        selectedConversation: formattedConversations[selectedConvoIndex],\n        sendMessage,\n      }}\n    >\n      {children}\n    </ConversationContext.Provider>\n  );\n};\n\nconst isArrayEqual = (array1, array2) => {\n  if (array1.length !== array2.length) return false;\n  array2.sort();\n  array1.sort();\n  return array1.every((element, index) => element === array2[index]);\n};\n","import React, { useCallback } from \"react\";\n\nfunction Message({ message, isLastMessage }) {\n  const setRef = useCallback((node) => {\n    if (node) {\n      node.scrollIntoView({ smooth: true });\n    }\n  }, []);\n  return (\n    <div\n      className={`my-1 d-flex flex-column ${\n        message.fromMe ? \"align-self-end\" : \"\"\n      }`}\n      ref={isLastMessage ? setRef : null}\n    >\n      <div\n        className={`rounded px-2 py-1 ${\n          message.fromMe ? \"bg-primary text-white\" : \"border\"\n        }`}\n      >\n        {message.text}\n      </div>\n      <div className={`text-muted small ${message.fromMe ? \"text-right\" : \"\"}`}>\n        {message.fromMe ? \"You\" : message.sender}\n      </div>\n    </div>\n  );\n}\n\nexport default Message;\n","import React from \"react\";\nimport Message from \"./Message\";\n\nfunction MessageList({ selectedConversation }) {\n  return (\n    <div className='d-flex flex-column align-items-start justify-content-end px-3'>\n      {selectedConversation.messages.map((message, index) => {\n        const isLastMessage =\n          selectedConversation.messages.length - 1 === index;\n        return (\n          <Message\n            isLastMessage={isLastMessage}\n            key={index}\n            message={message}\n          />\n        );\n      })}\n    </div>\n  );\n}\n\nexport default MessageList;\n","import React, { useState } from \"react\";\nimport { Form, InputGroup, Button } from \"react-bootstrap\";\nimport { useConversation } from \"../contexts/ConversationsProvider\";\nimport MessageList from \"./MessageList\";\n\nfunction Chat() {\n  const [text, setText] = useState(\"\");\n  const { sendMessage, selectedConversation } = useConversation();\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    sendMessage(text);\n    setText(\"\");\n  };\n\n  return (\n    <div className='d-flex flex-column flex-grow-1'>\n      <div className='flex-grow-1 overflow-auto'>\n        <MessageList selectedConversation={selectedConversation} />\n      </div>\n      <Form>\n        <Form.Group className='m-2'>\n          <InputGroup>\n            <Form.Control\n              as='textarea'\n              required\n              value={text}\n              onChange={(e) => setText(e.target.value)}\n              style={{ height: \"100px\", resize: \"none\" }}\n            />\n            <InputGroup.Append>\n              <Button onClick={handleSubmit} type='submit'>\n                Send\n              </Button>\n            </InputGroup.Append>\n          </InputGroup>\n        </Form.Group>\n      </Form>\n    </div>\n  );\n}\n\nexport default Chat;\n","import React from \"react\";\nimport { ListGroup } from \"react-bootstrap\";\nimport { useConversation } from \"../contexts/ConversationsProvider\";\n\nfunction Conversations() {\n  const { conversations, selectConversationIndex } = useConversation();\n  const displayNames = (array) => {\n    const names = array.map((member) => member.name);\n    return names.join(\", \");\n  };\n\n \n  return (\n    <ListGroup varaiant='flush'>\n      {conversations.map((convo, index) => {\n        return (\n          <ListGroup.Item\n            key={index}\n            action\n            active={convo.selected}\n            onClick={() => selectConversationIndex(index)}\n          >\n            {displayNames(convo.chatMembers)}\n          </ListGroup.Item>\n        );\n      })}\n    </ListGroup>\n  );\n}\n\nexport default Conversations;\n","import React, { useState } from \"react\";\nimport { Modal, Form, Button } from \"react-bootstrap\";\nimport { useContacts } from \"../contexts/ContactsProvider\";\nimport { useConversation } from \"../contexts/ConversationsProvider\";\n\nfunction ConversationsModal({ closeModal }) {\n  const { contacts } = useContacts();\n  const { createConversation } = useConversation();\n  const [selectedContactIds, setSelectedContactIds] = useState([]);\n\n  const handleCheckBox = id => {\n    setSelectedContactIds(prevContacts => {\n      if (prevContacts.includes(id)) {\n        return prevContacts.filter(prevId => prevId.id !== id);\n      } else {\n        return [...prevContacts, id];\n      }\n    });\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    createConversation(selectedContactIds);\n    closeModal();\n  };\n\n  return (\n    <>\n      <Modal.Header closeButton>Create Conversation</Modal.Header>\n      <Modal.Body>\n        <Form onSubmit={handleSubmit}>\n          {contacts.map(contact => {\n            return (\n              <Form.Group controlId={contact.id} key={contact.id}>\n                <Form.Check\n                  type='checkbox'\n                  value={selectedContactIds.includes(contact.id)}\n                  label={contact.name}\n                  onChange={() => {\n                    handleCheckBox(contact.id);\n                  }}\n                />\n              </Form.Group>\n            );\n          })}\n          <Button type='submit'>Create Conversation</Button>\n        </Form>\n      </Modal.Body>\n    </>\n  );\n}\n\nexport default ConversationsModal;\n","import React, { useRef } from \"react\";\nimport { Modal, Form, Button } from \"react-bootstrap\";\nimport { useContacts } from \"../contexts/ContactsProvider\";\n\nfunction ContactsModal({ closeModal }) {\n  const idRef = useRef();\n  const nameRef = useRef();\n  const { createContact } = useContacts()\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    createContact(idRef.current.value, nameRef.current.value);\n    closeModal();\n  };\n  return (\n    <>\n      <Modal.Header closeButton>Create Contact</Modal.Header>\n      <Modal.Body>\n        <Form onSubmit={handleSubmit}>\n          <Form.Group>\n            <Form.Label>ID</Form.Label>\n            <Form.Control type='text' ref={idRef} required />\n          </Form.Group>\n\n          <Form.Group>\n            <Form.Label>Name</Form.Label>\n            <Form.Control type='text' ref={nameRef} required />\n          </Form.Group>\n          <Button type='submit'>Create Contact</Button>\n        </Form>\n      </Modal.Body>\n    </>\n  );\n}\n\nexport default ContactsModal;\n","import React from \"react\";\nimport { ListGroup } from \"react-bootstrap\";\nimport { useContacts } from \"../contexts/ContactsProvider\";\n\nconst Contacts = () => {\n  const { contacts } = useContacts();\n  return (\n    <ListGroup varaiant='flush'>\n      {contacts.map(contact => {\n        return <ListGroup.Item key={contact.id}>{contact.name}</ListGroup.Item>;\n      })}\n    </ListGroup>\n  );\n};\n\nexport default Contacts;\n","import React, { useState } from \"react\";\nimport { Tab, Nav, Button, Modal } from \"react-bootstrap\";\nimport Conversations from \"./Conversations\";\nimport ConversationsModal from \"./ConversationsModal.js\";\nimport ContactsModal from \"./ContactsModal\";\nimport Contacts from \"./Contacts\";\nconst CONTACTS_KEY = \"contacts\";\nconst CONVERSATIONS_KEY = \"conversations\";\n\nfunction Sidebar({ id }) {\n  const [activeKey, setActiveKey] = useState(CONVERSATIONS_KEY);\n  const [showModal, setShowModal] = useState(false);\n\n  const conversationOpen = activeKey === CONVERSATIONS_KEY;\n  const closeModal = () => {\n    setShowModal(false);\n  };\n  return (\n    <div style={{ width: \"250px\" }} className='d-flex flex-column'>\n      <Tab.Container activeKey={activeKey} onSelect={setActiveKey}>\n        <Nav variant='tabs' className='justify-content-center'>\n          <Nav.Item>\n            <Nav.Link eventKey={CONVERSATIONS_KEY}> Conversations</Nav.Link>\n          </Nav.Item>\n          <Nav.Item>\n            <Nav.Link eventKey={CONTACTS_KEY}>Contacts</Nav.Link>\n          </Nav.Item>\n        </Nav>\n        <Tab.Content className='border-right overflow-auto flex-grow-1'>\n          <Tab.Pane eventKey={CONVERSATIONS_KEY}>\n            <Conversations />\n          </Tab.Pane>\n          <Tab.Pane eventKey={CONTACTS_KEY}>\n            <Contacts />\n          </Tab.Pane>\n        </Tab.Content>\n        <div className='p-2 border-top border-right small'>\n          Your ID <span className='text-muted'> {id}</span>\n        </div>\n        <Button className='rounded-0' onClick={() => setShowModal(true)}>\n          NEW {conversationOpen ? \"CONVERSATION\" : \"CONTACTS\"}\n        </Button>\n      </Tab.Container>\n\n      <Modal show={showModal} onHide={closeModal}>\n        {conversationOpen ? (\n          <ConversationsModal closeModal={closeModal} />\n        ) : (\n          <ContactsModal closeModal={closeModal} />\n        )}\n      </Modal>\n    </div>\n  );\n}\n\nexport default Sidebar;\n","import React from \"react\";\nimport { useConversation } from \"../contexts/ConversationsProvider\";\nimport Chat from \"./Chat\";\nimport Sidebar from \"./Sidebar\";\n\nfunction Dashboard({ id }) {\n  const { selectedConversation } = useConversation();\n  return (\n    <div className='d-flex' style={{ height: \"100vh\" }}>\n      <Sidebar id={id} />\n      {selectedConversation && <Chat />}\n    </div>\n  );\n}\n\nexport default Dashboard;\n","import React from \"react\";\nimport Login from \"./Login\";\nimport useLocalStorage from \"../hooks/useLocalStorage\";\nimport Dashboard from \"./Dashboard\";\nimport { ContactsProvider } from \"../contexts/ContactsProvider\";\nimport { ConversationsProvider } from \"../contexts/ConversationsProvider\";\nimport { SocketProvider } from \"../contexts/SocketProvider\";\n\nfunction App() {\n  const [id, setId] = useLocalStorage(\"id\", null);\n  const [name, setName] = useLocalStorage(\"name\", null);\n  const dashBoard = (\n    <SocketProvider id={id}>\n      <ContactsProvider>\n        <ConversationsProvider id={id}>\n          <Dashboard id={id} />\n        </ConversationsProvider>\n      </ContactsProvider>\n    </SocketProvider>\n  );\n  return id ? dashBoard : <Login setId={setId} setName={setName} />;\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./components/App\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n"],"sourceRoot":""}